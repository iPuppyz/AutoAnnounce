This plugin was actually mainly coded by a friend of mine, but I made quite a few edits so I'm putting it here.
